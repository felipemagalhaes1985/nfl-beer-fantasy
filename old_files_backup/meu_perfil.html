<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NFL Beer Fantasy - Meu Perfil</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <header>
        <div class="container">
            <h1>NFL Beer Fantasy</h1>
                        <nav>
    <ul>
        <li><a href="{{ url_for('home') }}">Home</a></li>
        {% if current_user.is_authenticated %} {# Só mostra links se o usuário estiver logado #}
            <li><a href="{{ url_for('meu_perfil') }}">Meu Perfil</a></li>
            <li><a href="{{ url_for('palpitar') }}">Palpitar</a></li>
            {# Se for admin, mostra o link para o painel administrativo #}
            {% if current_user.is_admin %}
                <li><a href="{{ url_for('admin_dashboard') }}">Painel Administrativo</a></li>
            {% endif %}
            <li><a href="{{ url_for('logout') }}">Sair</a></li>
        {% else %} {# Mostra links de login/registro se não estiver logado #}
            <li><a href="{{ url_for('login') }}">Entrar</a></li>
            <li><a href="{{ url_for('registro') }}">Registrar</a></li>
        {% endif %}
    </ul>
</nav>
        </div>
    </header>

    <main class="container">
        <h2>Perfil de {{ participante.nome }}</h2>
        <p><strong>Pontuação Total:</strong> {{ participante.pontuacao }} pts</p>

               <h3>Meus Palpites</h3>
        {% if palpites %}
        <table border="1">
            <thead>
                <tr>
                    <th>Jogo</th>
                    <th>Meu Palpite (Vencedor)</th>
                    <th>Meu Palpite (Placar)</th> {# NOVA COLUNA #}
                    <th>Resultado do Jogo (Vencedor)</th>
                    <th>Placar Final Real</th> {# NOVA COLUNA #}
                    <th>Pontuação Recebida</th>
                </tr>
            </thead>
            <tbody>
                            {% for palpite in palpites %}
                <tr>
                    <td>
                        {{ palpite.jogo.time1 }} vs. {{ palpite.jogo.time2 }} 
                        ({{ palpite.jogo.data_hora.strftime('%d/%m/%Y %H:%M') }})
                    </td>
                    <td>{# Coluna de Palpite #}
                        {% if is_public_profile and palpite.jogo.data_hora > (now_utc if 'now_utc' in globals() else moment().utc().toDate()) %} {# Se for perfil público E jogo futuro #}
                            Palpite Futuro (Visível após o jogo)
                        {% else %}
                            {{ palpite.escolha.replace('_', ' ').title() }}
                        {% endif %}
                    </td> 
                    <td>{# Coluna de Placar Palpite #}
                        {% if is_public_profile and palpite.jogo.data_hora > (now_utc if 'now_utc' in globals() else moment().utc().toDate()) %} {# Se for perfil público E jogo futuro #}
                            -
                        {% else %}
                            {% if palpite.palpite_placar_time1 is not none and palpite.palpite_placar_time2 is not none %}
                                {{ palpite.palpite_placar_time1 }} - {{ palpite.palpite_placar_time2 }}
                            {% else %}
                                N/A
                            {% endif %}
                        {% endif %}
                    </td>
                    <td>
    {% if palpite.jogo.resultado %}
        {{ palpite.jogo.resultado.replace('_', ' ').title() }}
    {% else %}
        Ainda não definido
    {% endif %}
</td>
                    <td>{# Coluna de Placar Final Real #}
                        {% if palpite.jogo.placar_time1_final is not none and palpite.jogo.placar_time2_final is not none %}
                            {{ palpite.jogo.placar_time1_final }} - {{ palpite.jogo.placar_time2_final }}
                        {% else %}
                            Aguardando...
                        {% endif %}
                    </td>
                    <td>{{ palpite.pontuacao_recebida }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        {% else %}
        <p>Você ainda não registrou nenhum palpite.</p>
        {% endif %}
    </main>

    <footer>
        <div class="container">
            <p>&copy; 2025 NFL Beer Fantasy. Todos os direitos reservados.</p>
        </div>
    </footer>
</body>
</html>